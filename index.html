<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti칩n de Ventas de Computadoras</title>
    <style>
        #crud-form {
            max-width: 400px;
            margin: 20px;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 0 10px #ffffff{0,0,0,0.1};
             
        }

    </style>
</head>
<body>
    <header class="cabecera">
        <section id="texto1">
            <div class="contenedor">
                <a href="index.html" title="P치gina de inicio">
                  
                </a>
                
            </div>
        </section>
    </header>
    <h1>Gesti칩n de Ventas de Computadoras</h1>
    <form id="crud-form">
        <label for="modelo">Modelo de Computadora:</label>
        <input type="text" id="modelo"><br><br>
        <label for="marca">Marca:</label>
        <input type="text" id="marca"><br><br>
        <label for="procesador">Procesador:</label>
        <input type="text" id="procesador"><br><br>
        <label for="almacenamiento">Almacenamiento (GB):</label>
        <input type="number" id="almacenamiento" min="0" required><br><br>
        <label for="ram">RAM (GB):</label>
        <input type="number" id="ram" min="0" required><br><br>
        <label for="precio">Precio:</label>
        <input type="number" id="precio" min="0" step="0.01" required><br><br>
        <label for="cantidad">Cantidad en Stock:</label>
        <input type="number" id="cantidad" min="0" required><br><br>
        <button type="button" id="btnAgregar">Agregar Computadora</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>Modelo</th>
                <th>Marca</th>
                <th>Procesador</th>
                <th>Almacenamiento</th>
                <th>RAM</th>
                <th>Precio</th>
                <th>Cantidad en Stock</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="tabla-body"></tbody>
    </table>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

        // Configuraci칩n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBB4VLEuWx4O57s4dfu9ii0BWLWJT33x58",
            authDomain: "proyectofari.firebaseapp.com",
            databaseURL: "https://proyectofari-default-rtdb.firebaseio.com",
            projectId: "proyectofari",
            storageBucket: "proyectofari.appspot.com",
            messagingSenderId: "538414020531",
            appId: "1:538414020531:web:08051bd59c98626d6a3dc6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        function agregarComputadora() {
            const modelo = document.getElementById("modelo").value;
            const marca = document.getElementById("marca").value;
            const procesador = document.getElementById("procesador").value;
            const almacenamiento = document.getElementById("almacenamiento").value;
            const ram = document.getElementById("ram").value;
            const precio = document.getElementById("precio").value;
            const cantidad = document.getElementById("cantidad").value;

            push(
                ref(database, 'computadoras'),
                {
                    modelo: modelo,
                    marca: marca,
                    procesador: procesador,
                    almacenamiento: almacenamiento,
                    ram: ram,
                    precio: precio,
                    cantidad: cantidad
                }
            );
        }

        function editarComputadora(key) {
            const computadoraRef = ref(database, `computadoras/${key}`);
            onValue(computadoraRef, (snapshot) => {
                const computadora = snapshot.val();

                document.getElementById('modelo').value = computadora?.modelo || '';
                document.getElementById('marca').value = computadora?.marca || '';
                document.getElementById('procesador').value = computadora?.procesador || '';
                document.getElementById('almacenamiento').value = computadora?.almacenamiento || '';
                document.getElementById('ram').value = computadora?.ram || '';
                document.getElementById('precio').value = computadora?.precio || '';
                document.getElementById('cantidad').value = computadora?.cantidad || '';
            });
        }

        function eliminarComputadora(key) {
            const computadoraRef = ref(database, `computadoras/${key}`);
            remove(computadoraRef);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const btnAgregar = document.getElementById('btnAgregar');
            btnAgregar.addEventListener('click', agregarComputadora);

            const tablaBody = document.getElementById('tabla-body');
            tablaBody.addEventListener('click', (event) => {
                const target = event.target;

                if (target.classList.contains('editar-btn')) {
                    const key = target.dataset.key;
                    editarComputadora(key);
                } else if (target.classList.contains('eliminar-btn')) {
                    const key = target.dataset.key;
                    eliminarComputadora(key);
                }
            });

            onValue(ref(database, 'computadoras'), (snapshot) => {
                renderizarTabla(snapshot.val());
            });
        });

        function renderizarTabla(computadoras) {
            const tablaBody = document.getElementById('tabla-body');
            tablaBody.innerHTML = "";

            for (const key in computadoras) {
                if (Object.hasOwnProperty.call(computadoras, key)) {
                    const computadora = computadoras[key];

                    const fila = document.createElement('tr');
                    fila.innerHTML = `
                        <td>${computadora.modelo}</td>
                        <td>${computadora.marca}</td>
                        <td>${computadora.procesador}</td>
                        <td>${computadora.almacenamiento}</td>
                        <td>${computadora.ram}</td>
                        <td>${computadora.precio}</td>
                        <td>${computadora.cantidad}</td>
                        <td>
                            <button data-key="${key}" class="editar-btn">Editar</button>
                            <button data-key="${key}" class="eliminar-btn">Eliminar</button>
                        </td>
                    `;

                    tablaBody.appendChild(fila);
                }
            }
        }
    </script>
</body>
</html>
